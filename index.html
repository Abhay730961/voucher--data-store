<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financial Management System</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7f9;
            color: #333;
            line-height: 1.6;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar Styles */
        .sidebar {
            width: 250px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            padding: 20px 0;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }

        .logo {
            text-align: center;
            padding: 20px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .logo h1 {
            font-size: 24px;
            font-weight: 600;
        }

        .menu {
            list-style: none;
            padding: 0;
        }

        .menu li {
            padding: 15px 25px;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }

        .menu li:hover {
            background: rgba(255, 255, 255, 0.1);
            border-left: 4px solid #4CAF50;
        }

        .menu li.active {
            background: rgba(255, 255, 255, 0.1);
            border-left: 4px solid #4CAF50;
        }

        .menu a {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .menu i {
            font-size: 18px;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 1px solid #e0e0e0;
        }

        .header h2 {
            font-size: 28px;
            color: #2a5298;
            font-weight: 600;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .user-info img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
        }

        /* Page Content Styles */
        .page-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .page-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Card Styles */
        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            padding: 25px;
            margin-bottom: 25px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .card-header h3 {
            font-size: 20px;
            color: #2a5298;
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #555;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 16px;
            transition: border 0.3s, box-shadow 0.3s;
        }

        .form-control:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
            outline: none;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-row .form-group {
            flex: 1;
        }

        /* Button Styles */
        .btn {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(0);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .btn-primary {
            background: linear-gradient(to right, #4CAF50, #45a049);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(to right, #45a049, #3d8b40);
        }

        .btn-secondary {
            background: linear-gradient(to right, #2196F3, #0b7dda);
            color: white;
        }

        .btn-secondary:hover {
            background: linear-gradient(to right, #0b7dda, #0a6ebd);
        }

        .btn-danger {
            background: linear-gradient(to right, #F44336, #d32f2f);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(to right, #d32f2f, #c62828);
        }

        .btn-warning {
            background: linear-gradient(to right, #FF9800, #F57C00);
            color: white;
        }

        .btn-warning:hover {
            background: linear-gradient(to right, #F57C00, #e65100);
        }

        .btn-info {
            background: linear-gradient(to right, #17a2b8, #138496);
            color: white;
        }

        .btn-info:hover {
            background: linear-gradient(to right, #138496, #11707d);
        }

        .btn-group {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
            margin-top: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2a5298;
        }

        tr {
            transition: background-color 0.3s;
        }

        tr:hover {
            background-color: #f5f5f5;
        }

        .action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .action-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s;
        }

        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        /* Tab Styles */
        .tabs {
            display: flex;
            gap: 5px;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
        }

        .tab {
            padding: 12px 25px;
            background: #f5f5f5;
            border-radius: 5px 5px 0 0;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s;
        }

        .tab:hover {
            background: #e0e0e0;
        }

        .tab.active {
            background: #4CAF50;
            color: white;
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        /* Dashboard Cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .stat-card i {
            font-size: 36px;
            margin-bottom: 15px;
            color: #4CAF50;
        }

        .stat-card h3 {
            font-size: 28px;
            margin-bottom: 10px;
            color: #2a5298;
        }

        .stat-card p {
            color: #777;
        }

        /* Monthly Summary Styles */
        .monthly-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .month-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .month-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

        .month-card h3 {
            color: #2a5298;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .month-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .month-stat {
            text-align: center;
            padding: 10px;
            border-radius: 8px;
        }

        .month-stat.advance {
            background-color: rgba(33, 150, 243, 0.1);
            color: #2196F3;
        }

        .month-stat.expense {
            background-color: rgba(244, 67, 54, 0.1);
            color: #F44336;
        }

        .month-stat.balance {
            grid-column: span 2;
            background-color: rgba(76, 175, 80, 0.1);
            color: #4CAF50;
            font-weight: bold;
        }

        .month-stat h4 {
            font-size: 20px;
            margin-bottom: 5px;
        }

        .month-stat p {
            font-size: 14px;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 20px;
            margin-top: 40px;
            color: #777;
            border-top: 1px solid #eee;
        }

        /* Print Styles */
        @media print {
            .sidebar, .btn-group, .action-buttons {
                display: none !important;
            }
            
            .main-content {
                width: 100%;
                margin: 0;
                padding: 15px;
            }
            
            .card {
                box-shadow: none;
                border: 1px solid #ddd;
            }
        }

        /* Responsive */
        @media (max-width: 992px) {
            .container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                padding: 10px;
            }
            .menu {
                display: flex;
                overflow-x: auto;
            }
            .menu li {
                padding: 10px 15px;
                border-left: none;
                border-bottom: 4px solid transparent;
            }
            .menu li.active, .menu li:hover {
                border-left: none;
                border-bottom: 4px solid #4CAF50;
            }
            
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                border-radius: 5px;
                margin-bottom: 5px;
            }

            .monthly-summary {
                grid-template-columns: 1fr;
            }
        }

        /* Animation for table rows */
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        tr {
            animation: slideIn 0.3s ease-out;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <h1>Finance Manager</h1>
            </div>
            <ul class="menu">
                <li class="active"><a href="#" onclick="showPage('home')"><i class="fas fa-home"></i> Home</a></li>
                <li><a href="#" onclick="showPage('voucher')"><i class="fas fa-receipt"></i> Voucher Form</a></li>
                <li><a href="#" onclick="showPage('expenses')"><i class="fas fa-money-bill-wave"></i> Expenses</a></li>
                <li><a href="#" onclick="showPage('about')"><i class="fas fa-info-circle"></i> About</a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <div class="header">
                <h2>Financial Management System</h2>
                <div class="user-info">
                    <img src="https://ui-avatars.com/api/?name=Admin&background=4CAF50&color=fff" alt="User">
                    <span>Admin</span>
                </div>
            </div>

            <!-- Home Page -->
            <div id="home" class="page-content active">
                <div class="stats-container">
                    <div class="stat-card">
                        <i class="fas fa-receipt"></i>
                        <h3 id="totalVouchers">0</h3>
                        <p>Total Vouchers</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-money-bill-wave"></i>
                        <h3 id="totalAmount">₹0</h3>
                        <p>Total Amount</p>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-chart-line"></i>
                        <h3 id="avgAmount">₹0</h3>
                        <p>Average Amount</p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Monthly Financial Summary</h3>
                    </div>
                    <div class="monthly-summary" id="monthlySummary">
                        <!-- Will be populated by JavaScript -->
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Recent Vouchers</h3>
                        <button class="btn btn-primary" onclick="showPage('voucher')">
                            <i class="fas fa-plus"></i> Create New
                        </button>
                    </div>
                    <div class="table-container">
                        <table id="recentVouchers">
                            <thead>
                                <tr>
                                    <th>Voucher No</th>
                                    <th>Date</th>
                                    <th>Paid To</th>
                                    <th>Amount</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Voucher Form Page -->
            <div id="voucher" class="page-content">
                <div class="card">
                    <div class="card-header">
                        <h3>Voucher Form</h3>
                        <button class="btn btn-secondary" onclick="clearVoucherForm()">
                            <i class="fas fa-broom"></i> Clear Form
                        </button>
                    </div>
                    <form id="voucherForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="voucherNo">Voucher No.</label>
                                <input type="text" id="voucherNo" class="form-control" placeholder="Enter voucher number">
                            </div>
                            <div class="form-group">
                                <label for="voucherDate">Date</label>
                                <input type="date" id="voucherDate" class="form-control">
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="paidTo">Paid To Ms.</label>
                            <input type="text" id="paidTo" class="form-control" placeholder="Enter recipient name">
                        </div>
                        
                        <div class="form-group">
                            <label for="purpose">Purpose (By Cash Against)</label>
                            <input type="text" id="purpose" class="form-control" placeholder="Enter purpose">
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="amount">Amount (₹)</label>
                                <input type="number" id="amount" class="form-control" placeholder="Enter amount" onblur="updateAmountWords()">
                            </div>
                            <div class="form-group">
                                <label for="amountWords">Amount in Words</label>
                                <input type="text" id="amountWords" class="form-control" placeholder="Amount in words" readonly>
                            </div>
                        </div>
                        
                        <div class="btn-group">
                            <button type="button" class="btn btn-primary" onclick="addVoucher()">
                                <i class="fas fa-plus"></i> Add
                            </button>
                            <button type="button" class="btn btn-secondary" onclick="updateVoucher()">
                                <i class="fas fa-edit"></i> Update
                            </button>
                            <button type="button" class="btn btn-danger" onclick="deleteVoucher()">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                            <button type="button" class="btn btn-warning" onclick="printVoucher()">
                                <i class="fas fa-print"></i> Print
                            </button>
                            <button type="button" class="btn btn-info" onclick="exportVouchersToExcel()">
                                <i class="fas fa-file-excel"></i> Export to Excel
                            </button>
                        </div>
                    </form>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3>Voucher Records</h3>
                        <button class="btn btn-secondary" onclick="refreshVouchers()">
                            <i class="fas fa-sync"></i> Refresh
                        </button>
                    </div>
                    <div class="table-container">
                        <table id="voucherTable">
                            <thead>
                                <tr>
                                    <th>Voucher No</th>
                                    <th>Date</th>
                                    <th>Paid To</th>
                                    <th>Purpose</th>
                                    <th>Amount</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Will be populated by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Expenses Page -->
            <div id="expenses" class="page-content">
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('advance')">Advance</div>
                    <div class="tab" onclick="switchTab('expenses-tab')">Expenses</div>
                    <div class="tab" onclick="switchTab('breakup')">Breakup</div>
                </div>

                <!-- Advance Tab -->
                <div id="advance" class="tab-content active">
                    <div class="card">
                        <div class="card-header">
                            <h3>Advance Form</h3>
                            <button class="btn btn-secondary" onclick="clearAdvanceForm()">
                                <i class="fas fa-broom"></i> Clear Form
                            </button>
                        </div>
                        <form id="advanceForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="advanceDate">Date</label>
                                    <input type="date" id="advanceDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="month">Month</label>
                                    <select id="month" class="form-control">
                                        <option value="">Select Month</option>
                                        <option value="january">January</option>
                                        <option value="february">February</option>
                                        <option value="march">March</option>
                                        <option value="april">April</option>
                                        <option value="may">May</option>
                                        <option value="june">June</option>
                                        <option value="july">July</option>
                                        <option value="august">August</option>
                                        <option value="september">September</option>
                                        <option value="october">October</option>
                                        <option value="november">November</option>
                                        <option value="december">December</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="advanceAmount">Amount</label>
                                <input type="number" id="advanceAmount" class="form-control" placeholder="Enter amount">
                            </div>
                            
                            <div class="form-group">
                                <label for="remarks">Remarks</label>
                                <textarea id="remarks" class="form-control" rows="3" placeholder="Enter remarks"></textarea>
                            </div>
                            
                            <div class="btn-group">
                                <button type="button" class="btn btn-primary" onclick="addAdvance()">
                                    <i class="fas fa-plus"></i> Add
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="updateAdvance()">
                                    <i class="fas fa-edit"></i> Update
                                </button>
                                <button type="button" class="btn btn-danger" onclick="deleteAdvance()">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                                <button type="button" class="btn btn-warning" onclick="printAdvance()">
                                    <i class="fas fa-print"></i> Print Report
                                </button>
                                <button type="button" class="btn btn-info" onclick="exportAdvanceToExcel()">
                                    <i class="fas fa-file-excel"></i> Export to Excel
                                </button>
                            </div>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Advance Records</h3>
                            <button class="btn btn-secondary" onclick="refreshAdvances()">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                        <div class="table-container">
                            <table id="advanceTable">
                                <thead>
                                    <tr>
                                        <th>Date</th>
                                        <th>Month</th>
                                        <th>Amount</th>
                                        <th>Remarks</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Expenses Tab -->
                <div id="expenses-tab" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h3>Expenses Form</h3>
                            <button class="btn btn-secondary" onclick="clearExpenseForm()">
                                <i class="fas fa-broom"></i> Clear Form
                            </button>
                        </div>
                        <form id="expensesForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expenseDate">Date</label>
                                    <input type="date" id="expenseDate" class="form-control">
                                </div>
                                <div class="form-group">
                                    <label for="expenseType">Expense Type</label>
                                    <select id="expenseType" class="form-control">
                                        <option value="">Select Expense Type</option>
                                        <option value="office">Office Supplies</option>
                                        <option value="travel">Travel</option>
                                        <option value="utilities">Utilities</option>
                                        <option value="maintenance">Maintenance</option>
                                        <option value="marketing">Marketing</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="description">Description</label>
                                <select id="description" class="form-control">
                                    <option value="">Select Description</option>
                                    <option value="stationery">Stationery Purchase</option>
                                    <option value="internet">Internet Bill</option>
                                    <option value="transport">Transportation</option>
                                    <option value="repair">Equipment Repair</option>
                                    <option value="advertising">Advertising</option>
                                </select>
                            </div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="expenseAmount">Amount</label>
                                    <input type="number" id="expenseAmount" class="form-control" placeholder="Enter amount">
                                </div>
                                <div class="form-group">
                                    <label for="billNo">Bill No.</label>
                                    <input type="text" id="billNo" class="form-control" placeholder="Enter bill number">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label for="expenseRemarks">Remarks</label>
                                <textarea id="expenseRemarks" class="form-control" rows="3" placeholder="Enter remarks"></textarea>
                            </div>
                            
                            <div class="btn-group">
                                <button type="button" class="btn btn-primary" onclick="addExpense()">
                                    <i class="fas fa-plus"></i> Add
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="updateExpense()">
                                    <i class="fas fa-edit"></i> Update
                                </button>
                                <button type="button" class="btn btn-danger" onclick="deleteExpense()">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                                <button type="button" class="btn btn-warning" onclick="printExpense()">
                                    <i class="fas fa-print"></i> Print
                                </button>
                                <button type="button" class="btn btn-info" onclick="exportExpensesToExcel()">
                                    <i class="fas fa-file-excel"></i> Export to Excel
                                </button>
                            </div>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Expenses Records</h3>
                            <button class="btn btn-secondary" onclick="refreshExpenses()">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                        <div class="table-container">
                            <table id="expenseTable">
                                <thead>
                                    <tr>
                                        <th>Sr.</th>
                                        <th>Date</th>
                                        <th>Expense Type</th>
                                        <th>Description</th>
                                        <th>Amount</th>
                                        <th>Bill No.</th>
                                        <th>Remarks</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Breakup Tab -->
                <div id="breakup" class="tab-content">
                    <div class="card">
                        <div class="card-header">
                            <h3>Expense Breakup</h3>
                            <button class="btn btn-secondary" onclick="clearBreakupForm()">
                                <i class="fas fa-broom"></i> Clear Form
                            </button>
                        </div>
                        <form id="breakupForm">
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="breakupExpenseType">Expense Type</label>
                                    <select id="breakupExpenseType" class="form-control">
                                        <option value="">Select Expense Type</option>
                                        <option value="office">Office Supplies</option>
                                        <option value="travel">Travel</option>
                                        <option value="utilities">Utilities</option>
                                        <option value="maintenance">Maintenance</option>
                                        <option value="marketing">Marketing</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="breakupDescription">Description</label>
                                    <input type="text" id="breakupDescription" class="form-control" placeholder="Enter description">
                                </div>
                            </div>
                            
                            <div class="btn-group">
                                <button type="button" class="btn btn-primary" onclick="addBreakup()">
                                    <i class="fas fa-plus"></i> Add
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="updateBreakup()">
                                    <i class="fas fa-edit"></i> Update
                                </button>
                                <button type="button" class="btn btn-danger" onclick="deleteBreakup()">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                                <button type="button" class="btn btn-warning" onclick="printBreakup()">
                                    <i class="fas fa-print"></i> Print
                                </button>
                                <button type="button" class="btn btn-info" onclick="exportBreakupToExcel()">
                                    <i class="fas fa-file-excel"></i> Export to Excel
                                </button>
                            </div>
                        </form>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Breakup Records</h3>
                            <button class="btn btn-secondary" onclick="refreshBreakups()">
                                <i class="fas fa-sync"></i> Refresh
                            </button>
                        </div>
                        <div class="table-container">
                            <table id="breakupTable">
                                <thead>
                                    <tr>
                                        <th>Expense Type</th>
                                        <th>Description</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>

            <!-- About Page -->
            <div id="about" class="page-content">
                <div class="card">
                    <div class="card-header">
                        <h3>About Financial Management System</h3>
                    </div>
                    <div style="padding: 20px;">
                        <p>This Financial Management System is designed to help businesses manage their financial transactions efficiently. The system includes:</p>
                        
                        <ul style="margin: 20px 0 20px 30px;">
                            <li>Voucher management with add, edit, delete, print, and export capabilities</li>
                            <li>Expense tracking with categorization</li>
                            <li>Advance payment management</li>
                            <li>Detailed reporting features</li>
                            <li>Data export to Excel for further analysis</li>
                        </ul>
                        
                        <p>The system is built using modern web technologies including HTML5, CSS3, and JavaScript, ensuring a responsive and user-friendly experience across devices.</p>
                        
                        <h4 style="margin: 20px 0 10px 0;">Version Information</h4>
                        <p><strong>Version:</strong> 1.0.0</p>
                        <p><strong>Release Date:</strong> August 17, 2023</p>
                    </div>
                </div>
            </div>

            <div class="footer">
                <p>&copy; 2023 Financial Management System. All rights reserved.</p>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let vouchers = JSON.parse(localStorage.getItem('vouchers')) || [];
        let advances = JSON.parse(localStorage.getItem('advances')) || [];
        let expenses = JSON.parse(localStorage.getItem('expenses')) || [];
        let breakups = JSON.parse(localStorage.getItem('breakups')) || [];
        
        let currentVoucherId = null;
        let currentAdvanceId = null;
        let currentExpenseId = null;
        let currentBreakupId = null;

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date as default
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('voucherDate').value = today;
            document.getElementById('advanceDate').value = today;
            document.getElementById('expenseDate').value = today;
            
            // Set current month as default
            const months = ['january', 'february', 'march', 'april', 'may', 'june', 
                           'july', 'august', 'september', 'october', 'november', 'december'];
            const currentMonth = months[new Date().getMonth()];
            document.getElementById('month').value = currentMonth;
            
            // Load data
            refreshVouchers();
            refreshAdvances();
            refreshExpenses();
            refreshBreakups();
            updateDashboard();
            updateMonthlySummary();
        });

        // Show a specific page
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.remove('active');
            });
            
            document.getElementById(pageId).classList.add('active');
            
            // Update menu active state
            document.querySelectorAll('.menu li').forEach(item => {
                item.classList.remove('active');
            });
            
            // Set the active menu item based on the page
            const menuItems = document.querySelectorAll('.menu li a');
            for (let item of menuItems) {
                if (item.getAttribute('onclick').includes(pageId)) {
                    item.parentElement.classList.add('active');
                    break;
                }
            }
            
            // Update monthly summary when home page is shown
            if (pageId === 'home') {
                updateMonthlySummary();
            }
        }

        // Switch between tabs in expenses section
        function switchTab(tabId) {
            // Remove active class from all tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Hide all tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Show the selected tab content
            document.getElementById(tabId).classList.add('active');
        }

        // Convert amount to words
        function updateAmountWords() {
            const amount = document.getElementById('amount').value;
            if (amount) {
                document.getElementById('amountWords').value = convertToWords(parseInt(amount));
            } else {
                document.getElementById('amountWords').value = '';
            }
        }

        // Simple number to words conversion for demonstration
        function convertToWords(num) {
            if (num === 0) return 'Zero Rupees';
            
            const ones = ['', 'One', 'Two', 'Three', 'Four', 'Five', 'Six', 'Seven', 'Eight', 'Nine'];
            const teens = ['Ten', 'Eleven', 'Twelve', 'Thirteen', 'Fourteen', 'Fifteen', 'Sixteen', 'Seventeen', 'Eighteen', 'Nineteen'];
            const tens = ['', '', 'Twenty', 'Thirty', 'Forty', 'Fifty', 'Sixty', 'Seventy', 'Eighty', 'Ninety'];
            
            if (num < 10) return ones[num] + ' Rupees';
            if (num < 20) return teens[num - 10] + ' Rupees';
            if (num < 100) return tens[Math.floor(num / 10)] + (num % 10 !== 0 ? ' ' + ones[num % 10] : '') + ' Rupees';
            if (num < 1000) return ones[Math.floor(num / 100)] + ' Hundred' + (num % 100 !== 0 ? ' and ' + convertToWords(num % 100) : ' Rupees');
            if (num < 100000) return convertToWords(Math.floor(num / 1000)) + ' Thousand' + (num % 1000 !== 0 ? ' ' + convertToWords(num % 1000) : '');
            if (num < 10000000) return convertToWords(Math.floor(num / 100000)) + ' Lakh' + (num % 100000 !== 0 ? ' ' + convertToWords(num % 100000) : '');
            
            return 'Number too large for demo';
        }

        // Voucher Functions
        function addVoucher() {
            const voucherNo = document.getElementById('voucherNo').value;
            const date = document.getElementById('voucherDate').value;
            const paidTo = document.getElementById('paidTo').value;
            const purpose = document.getElementById('purpose').value;
            const amount = document.getElementById('amount').value;
            
            if (!voucherNo || !date || !paidTo || !purpose || !amount) {
                alert('Please fill all fields');
                return;
            }
            
            // Check if voucher number already exists
            if (vouchers.some(v => v.voucherNo === voucherNo)) {
                alert('Voucher number already exists');
                return;
            }
            
            const voucher = {
                id: Date.now(),
                voucherNo,
                date,
                paidTo,
                purpose,
                amount
            };
            
            vouchers.push(voucher);
            saveVouchers();
            refreshVouchers();
            updateDashboard();
            clearVoucherForm();
            
            alert('Voucher added successfully!');
        }

        function updateVoucher() {
            if (!currentVoucherId) {
                alert('Please select a voucher to update');
                return;
            }
            
            const voucherNo = document.getElementById('voucherNo').value;
            const date = document.getElementById('voucherDate').value;
            const paidTo = document.getElementById('paidTo').value;
            const purpose = document.getElementById('purpose').value;
            const amount = document.getElementById('amount').value;
            
            if (!voucherNo || !date || !paidTo || !purpose || !amount) {
                alert('Please fill all fields');
                return;
            }
            
            // Check if voucher number already exists (excluding current voucher)
            if (vouchers.some(v => v.voucherNo === voucherNo && v.id !== currentVoucherId)) {
                alert('Voucher number already exists');
                return;
            }
            
            const index = vouchers.findIndex(v => v.id === currentVoucherId);
            if (index !== -1) {
                vouchers[index] = {
                    id: currentVoucherId,
                    voucherNo,
                    date,
                    paidTo,
                    purpose,
                    amount
                };
                
                saveVouchers();
                refreshVouchers();
                updateDashboard();
                clearVoucherForm();
                
                alert('Voucher updated successfully!');
            }
        }

        function deleteVoucher() {
            if (!currentVoucherId) {
                alert('Please select a voucher to delete');
                return;
            }
            
            if (confirm('Are you sure you want to delete this voucher?')) {
                vouchers = vouchers.filter(v => v.id !== currentVoucherId);
                saveVouchers();
                refreshVouchers();
                updateDashboard();
                clearVoucherForm();
                
                alert('Voucher deleted successfully!');
            }
        }

        function printVoucher() {
            if (!currentVoucherId) {
                alert('Please select a voucher to print');
                return;
            }
            
            window.print();
        }

        function exportVouchersToExcel() {
            if (vouchers.length === 0) {
                alert('No vouchers to export');
                return;
            }
            
            // Prepare data for export
            const data = vouchers.map(v => ({
                'Voucher No': v.voucherNo,
                'Date': v.date,
                'Paid To': v.paidTo,
                'Purpose': v.purpose,
                'Amount': v.amount
            }));
            
            // Create worksheet
            const ws = XLSX.utils.json_to_sheet(data);
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Vouchers');
            
            // Export to Excel
            XLSX.writeFile(wb, 'vouchers.xlsx');
            
            alert('Vouchers exported to Excel successfully!');
        }

        function clearVoucherForm() {
            document.getElementById('voucherNo').value = '';
            document.getElementById('voucherDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('paidTo').value = '';
            document.getElementById('purpose').value = '';
            document.getElementById('amount').value = '';
            document.getElementById('amountWords').value = '';
            currentVoucherId = null;
        }

        function refreshVouchers() {
            const tbody = document.getElementById('voucherTable').querySelector('tbody');
            tbody.innerHTML = '';
            
            if (vouchers.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" style="text-align: center;">No vouchers found</td></tr>';
                return;
            }
            
            vouchers.forEach(voucher => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${voucher.voucherNo}</td>
                    <td>${voucher.date}</td>
                    <td>${voucher.paidTo}</td>
                    <td>${voucher.purpose}</td>
                    <td>₹${voucher.amount}</td>
                    <td class="action-buttons">
                        <button class="action-btn btn-primary" onclick="selectVoucher(${voucher.id})"><i class="fas fa-edit"></i> Edit</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function selectVoucher(id) {
            const voucher = vouchers.find(v => v.id === id);
            if (voucher) {
                document.getElementById('voucherNo').value = voucher.voucherNo;
                document.getElementById('voucherDate').value = voucher.date;
                document.getElementById('paidTo').value = voucher.paidTo;
                document.getElementById('purpose').value = voucher.purpose;
                document.getElementById('amount').value = voucher.amount;
                updateAmountWords();
                
                currentVoucherId = voucher.id;
                
                // Scroll to form
                document.getElementById('voucherForm').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function saveVouchers() {
            localStorage.setItem('vouchers', JSON.stringify(vouchers));
        }

        // Advance Functions
        function addAdvance() {
            const date = document.getElementById('advanceDate').value;
            const month = document.getElementById('month').value;
            const amount = document.getElementById('advanceAmount').value;
            const remarks = document.getElementById('remarks').value;
            
            if (!date || !month || !amount) {
                alert('Please fill all required fields');
                return;
            }
            
            const advance = {
                id: Date.now(),
                date,
                month,
                amount,
                remarks
            };
            
            advances.push(advance);
            saveAdvances();
            refreshAdvances();
            clearAdvanceForm();
            updateMonthlySummary();
            
            alert('Advance added successfully!');
        }

        function updateAdvance() {
            if (!currentAdvanceId) {
                alert('Please select an advance to update');
                return;
            }
            
            const date = document.getElementById('advanceDate').value;
            const month = document.getElementById('month').value;
            const amount = document.getElementById('advanceAmount').value;
            const remarks = document.getElementById('remarks').value;
            
            if (!date || !month || !amount) {
                alert('Please fill all required fields');
                return;
            }
            
            const index = advances.findIndex(a => a.id === currentAdvanceId);
            if (index !== -1) {
                advances[index] = {
                    id: currentAdvanceId,
                    date,
                    month,
                    amount,
                    remarks
                };
                
                saveAdvances();
                refreshAdvances();
                clearAdvanceForm();
                updateMonthlySummary();
                
                alert('Advance updated successfully!');
            }
        }

        function deleteAdvance() {
            if (!currentAdvanceId) {
                alert('Please select an advance to delete');
                return;
            }
            
            if (confirm('Are you sure you want to delete this advance?')) {
                advances = advances.filter(a => a.id !== currentAdvanceId);
                saveAdvances();
                refreshAdvances();
                clearAdvanceForm();
                updateMonthlySummary();
                
                alert('Advance deleted successfully!');
            }
        }

        function printAdvance() {
            window.print();
        }

        function exportAdvanceToExcel() {
            if (advances.length === 0) {
                alert('No advances to export');
                return;
            }
            
            // Prepare data for export
            const data = advances.map(a => ({
                'Date': a.date,
                'Month': a.month,
                'Amount': a.amount,
                'Remarks': a.remarks
            }));
            
            // Create worksheet
            const ws = XLSX.utils.json_to_sheet(data);
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Advances');
            
            // Export to Excel
            XLSX.writeFile(wb, 'advances.xlsx');
            
            alert('Advances exported to Excel successfully!');
        }

        function clearAdvanceForm() {
            document.getElementById('advanceDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('month').value = '';
            document.getElementById('advanceAmount').value = '';
            document.getElementById('remarks').value = '';
            currentAdvanceId = null;
        }

        function refreshAdvances() {
            const tbody = document.getElementById('advanceTable').querySelector('tbody');
            tbody.innerHTML = '';
            
            if (advances.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" style="text-align: center;">No advances found</td></tr>';
                return;
            }
            
            advances.forEach(advance => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${advance.date}</td>
                    <td>${advance.month}</td>
                    <td>₹${advance.amount}</td>
                    <td>${advance.remarks}</td>
                    <td class="action-buttons">
                        <button class="action-btn btn-primary" onclick="selectAdvance(${advance.id})"><i class="fas fa-edit"></i> Edit</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function selectAdvance(id) {
            const advance = advances.find(a => a.id === id);
            if (advance) {
                document.getElementById('advanceDate').value = advance.date;
                document.getElementById('month').value = advance.month;
                document.getElementById('advanceAmount').value = advance.amount;
                document.getElementById('remarks').value = advance.remarks;
                
                currentAdvanceId = advance.id;
                
                // Scroll to form
                document.getElementById('advanceForm').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function saveAdvances() {
            localStorage.setItem('advances', JSON.stringify(advances));
        }

        // Expense Functions
        function addExpense() {
            const date = document.getElementById('expenseDate').value;
            const expenseType = document.getElementById('expenseType').value;
            const description = document.getElementById('description').value;
            const amount = document.getElementById('expenseAmount').value;
            const billNo = document.getElementById('billNo').value;
            const remarks = document.getElementById('expenseRemarks').value;
            
            if (!date || !expenseType || !description || !amount) {
                alert('Please fill all required fields');
                return;
            }
            
            const expense = {
                id: Date.now(),
                date,
                expenseType,
                description,
                amount,
                billNo,
                remarks
            };
            
            expenses.push(expense);
            saveExpenses();
            refreshExpenses();
            clearExpenseForm();
            updateMonthlySummary();
            
            alert('Expense added successfully!');
        }

        function updateExpense() {
            if (!currentExpenseId) {
                alert('Please select an expense to update');
                return;
            }
            
            const date = document.getElementById('expenseDate').value;
            const expenseType = document.getElementById('expenseType').value;
            const description = document.getElementById('description').value;
            const amount = document.getElementById('expenseAmount').value;
            const billNo = document.getElementById('billNo').value;
            const remarks = document.getElementById('expenseRemarks').value;
            
            if (!date || !expenseType || !description || !amount) {
                alert('Please fill all required fields');
                return;
            }
            
            const index = expenses.findIndex(e => e.id === currentExpenseId);
            if (index !== -1) {
                expenses[index] = {
                    id: currentExpenseId,
                    date,
                    expenseType,
                    description,
                    amount,
                    billNo,
                    remarks
                };
                
                saveExpenses();
                refreshExpenses();
                clearExpenseForm();
                updateMonthlySummary();
                
                alert('Expense updated successfully!');
            }
        }

        function deleteExpense() {
            if (!currentExpenseId) {
                alert('Please select an expense to delete');
                return;
            }
            
            if (confirm('Are you sure you want to delete this expense?')) {
                expenses = expenses.filter(e => e.id !== currentExpenseId);
                saveExpenses();
                refreshExpenses();
                clearExpenseForm();
                updateMonthlySummary();
                
                alert('Expense deleted successfully!');
            }
        }

        function printExpense() {
            window.print();
        }

        function exportExpensesToExcel() {
            if (expenses.length === 0) {
                alert('No expenses to export');
                return;
            }
            
            // Prepare data for export
            const data = expenses.map(e => ({
                'Date': e.date,
                'Expense Type': e.expenseType,
                'Description': e.description,
                'Amount': e.amount,
                'Bill No': e.billNo,
                'Remarks': e.remarks
            }));
            
            // Create worksheet
            const ws = XLSX.utils.json_to_sheet(data);
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Expenses');
            
            // Export to Excel
            XLSX.writeFile(wb, 'expenses.xlsx');
            
            alert('Expenses exported to Excel successfully!');
        }

        function clearExpenseForm() {
            document.getElementById('expenseDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('expenseType').value = '';
            document.getElementById('description').value = '';
            document.getElementById('expenseAmount').value = '';
            document.getElementById('billNo').value = '';
            document.getElementById('expenseRemarks').value = '';
            currentExpenseId = null;
        }

        function refreshExpenses() {
            const tbody = document.getElementById('expenseTable').querySelector('tbody');
            tbody.innerHTML = '';
            
            if (expenses.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" style="text-align: center;">No expenses found</td></tr>';
                return;
            }
            
            expenses.forEach((expense, index) => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${index + 1}</td>
                    <td>${expense.date}</td>
                    <td>${expense.expenseType}</td>
                    <td>${expense.description}</td>
                    <td>₹${expense.amount}</td>
                    <td>${expense.billNo}</td>
                    <td>${expense.remarks}</td>
                    <td class="action-buttons">
                        <button class="action-btn btn-primary" onclick="selectExpense(${expense.id})"><i class="fas fa-edit"></i> Edit</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function selectExpense(id) {
            const expense = expenses.find(e => e.id === id);
            if (expense) {
                document.getElementById('expenseDate').value = expense.date;
                document.getElementById('expenseType').value = expense.expenseType;
                document.getElementById('description').value = expense.description;
                document.getElementById('expenseAmount').value = expense.amount;
                document.getElementById('billNo').value = expense.billNo;
                document.getElementById('expenseRemarks').value = expense.remarks;
                
                currentExpenseId = expense.id;
                
                // Scroll to form
                document.getElementById('expensesForm').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function saveExpenses() {
            localStorage.setItem('expenses', JSON.stringify(expenses));
        }

        // Breakup Functions
        function addBreakup() {
            const expenseType = document.getElementById('breakupExpenseType').value;
            const description = document.getElementById('breakupDescription').value;
            
            if (!expenseType || !description) {
                alert('Please fill all fields');
                return;
            }
            
            const breakup = {
                id: Date.now(),
                expenseType,
                description
            };
            
            breakups.push(breakup);
            saveBreakups();
            refreshBreakups();
            clearBreakupForm();
            
            alert('Breakup added successfully!');
        }

        function updateBreakup() {
            if (!currentBreakupId) {
                alert('Please select a breakup to update');
                return;
            }
            
            const expenseType = document.getElementById('breakupExpenseType').value;
            const description = document.getElementById('breakupDescription').value;
            
            if (!expenseType || !description) {
                alert('Please fill all fields');
                return;
            }
            
            const index = breakups.findIndex(b => b.id === currentBreakupId);
            if (index !== -1) {
                breakups[index] = {
                    id: currentBreakupId,
                    expenseType,
                    description
                };
                
                saveBreakups();
                refreshBreakups();
                clearBreakupForm();
                
                alert('Breakup updated successfully!');
            }
        }

        function deleteBreakup() {
            if (!currentBreakupId) {
                alert('Please select a breakup to delete');
                return;
            }
            
            if (confirm('Are you sure you want to delete this breakup?')) {
                breakups = breakups.filter(b => b.id !== currentBreakupId);
                saveBreakups();
                refreshBreakups();
                clearBreakupForm();
                
                alert('Breakup deleted successfully!');
            }
        }

        function printBreakup() {
            window.print();
        }

        function exportBreakupToExcel() {
            if (breakups.length === 0) {
                alert('No breakups to export');
                return;
            }
            
            // Prepare data for export
            const data = breakups.map(b => ({
                'Expense Type': b.expenseType,
                'Description': b.description
            }));
            
            // Create worksheet
            const ws = XLSX.utils.json_to_sheet(data);
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Breakups');
            
            // Export to Excel
            XLSX.writeFile(wb, 'breakups.xlsx');
            
            alert('Breakups exported to Excel successfully!');
        }

        function clearBreakupForm() {
            document.getElementById('breakupExpenseType').value = '';
            document.getElementById('breakupDescription').value = '';
            currentBreakupId = null;
        }

        function refreshBreakups() {
            const tbody = document.getElementById('breakupTable').querySelector('tbody');
            tbody.innerHTML = '';
            
            if (breakups.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center;">No breakups found</td></tr>';
                return;
            }
            
            breakups.forEach(breakup => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${breakup.expenseType}</td>
                    <td>${breakup.description}</td>
                    <td class="action-buttons">
                        <button class="action-btn btn-primary" onclick="selectBreakup(${breakup.id})"><i class="fas fa-edit"></i> Edit</button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function selectBreakup(id) {
            const breakup = breakups.find(b => b.id === id);
            if (breakup) {
                document.getElementById('breakupExpenseType').value = breakup.expenseType;
                document.getElementById('breakupDescription').value = breakup.description;
                
                currentBreakupId = breakup.id;
                
                // Scroll to form
                document.getElementById('breakupForm').scrollIntoView({ behavior: 'smooth' });
            }
        }

        function saveBreakups() {
            localStorage.setItem('breakups', JSON.stringify(breakups));
        }

        // Update dashboard statistics
        function updateDashboard() {
            document.getElementById('totalVouchers').textContent = vouchers.length;
            
            const totalAmount = vouchers.reduce((sum, v) => sum + parseInt(v.amount || 0), 0);
            document.getElementById('totalAmount').textContent = `₹${totalAmount}`;
            
            const avgAmount = vouchers.length > 0 ? Math.round(totalAmount / vouchers.length) : 0;
            document.getElementById('avgAmount').textContent = `₹${avgAmount}`;
            
            // Update recent vouchers table
            const recentTbody = document.getElementById('recentVouchers').querySelector('tbody');
            recentTbody.innerHTML = '';
            
            const recentVouchers = vouchers.slice(-3).reverse();
            
            if (recentVouchers.length === 0) {
                recentTbody.innerHTML = '<tr><td colspan="4" style="text-align: center;">No recent vouchers</td></tr>';
                return;
            }
            
            recentVouchers.forEach(voucher => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td>${voucher.voucherNo}</td>
                    <td>${voucher.date}</td>
                    <td>${voucher.paidTo}</td>
                    <td>₹${voucher.amount}</td>
                `;
                recentTbody.appendChild(tr);
            });
        }

        // Update monthly summary
        function updateMonthlySummary() {
            const monthlySummary = document.getElementById('monthlySummary');
            monthlySummary.innerHTML = '';
            
            const months = ['january', 'february', 'march', 'april', 'may', 'june', 
                           'july', 'august', 'september', 'october', 'november', 'december'];
            
            months.forEach(month => {
                // Calculate total advance for the month
                const monthAdvances = advances.filter(a => a.month === month);
                const totalAdvance = monthAdvances.reduce((sum, a) => sum + parseInt(a.amount || 0), 0);
                
                // Calculate total expenses for the month
                const monthExpenses = expenses.filter(e => {
                    const expenseDate = new Date(e.date);
                    const expenseMonth = months[expenseDate.getMonth()];
                    return expenseMonth === month;
                });
                const totalExpense = monthExpenses.reduce((sum, e) => sum + parseInt(e.amount || 0), 0);
                
                // Calculate balance
                const balance = totalAdvance - totalExpense;
                
                // Only show months with data
                if (totalAdvance > 0 || totalExpense > 0) {
                    const monthCard = document.createElement('div');
                    monthCard.className = 'month-card';
                    
                    monthCard.innerHTML = `
                        <h3>${month.charAt(0).toUpperCase() + month.slice(1)}</h3>
                        <div class="month-stats">
                            <div class="month-stat advance">
                                <h4>₹${totalAdvance}</h4>
                                <p>Total Advance</p>
                            </div>
                            <div class="month-stat expense">
                                <h4>₹${totalExpense}</h4>
                                <p>Total Expenses</p>
                            </div>
                            <div class="month-stat balance">
                                <h4>₹${balance}</h4>
                                <p>Balance</p>
                            </div>
                        </div>
                    `;
                    
                    monthlySummary.appendChild(monthCard);
                }
            });
            
            if (monthlySummary.innerHTML === '') {
                monthlySummary.innerHTML = '<p style="text-align: center; padding: 20px;">No monthly data available</p>';
            }
        }
    </script>
</body>
</html>